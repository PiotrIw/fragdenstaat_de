{% extends "base.html" %}


{% block body %}
<div class="container mb-5 mt-5">
  <div class="row justify-content-center">
    <div class="col-md-8">
      <h1>Klageautomat testen:</h1>

      <form action="" method="get" class="row g-3">
          <div class="col-12">
            <label for="inputSearch" class="form-label">Suche</label>
            <input type="text" {% if request.GET.Search %}value="{{ request.GET.Search }}"{% endif %} class="form-control" name="Search" placeholder="Titel der Anfrage">
          </div>
          <div class="col-12">
            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="gridCheck" name="allRequests" {% if request.GET.allRequests == "on" %}checked{% endif %}>
              <label class="form-check-label" for="gridCheck">
                In allen Anfragen suchen (nicht nur meine)
              </label>
            </div>
          </div>
          <div class="col-12">
            <button type="submit" class="btn btn-primary float-right">Go!</button>
            {% if request.GET.allRequests or request.GET.Search %}
            <a href="{% url 'klageautomat-index' %}" type="submit" class="btn btn-link float-right mr-1">Clear</a>
            {% endif %}
          </div>
      </form>

      {% if foi_requests %}
      <ul class="list-group mt-5">
        {% for foirequest in foi_requests %}
        <li class="list-group-item px-0 border-0">
          <div class="card">
            <div class="card-body">
              {% if foirequest.answer_exists %}
              <div class="alert alert-info rounded-0" role="alert">
                <small>Zu dieser Anfrage wurde bereits eine Klage erstellt.</small>
              </div>
              {% endif %}
              <h5 class="card-title">{{ foirequest }}</h5>
              <div class="card-subtitle text-muted">
                <small>an: {{ foirequest.public_body.name }}</small>
              </div>
            </div>
            <div class="card-footer bg-white text-right">
              <a href="{% url 'klageautomat-form_wizard' foirequest.id %}" class="btn btn-link btn-sm">
                {% if foirequest.answer_exists %}
                  Klage neu erstellen
                {% else %}
                  Klage erstellen
                {% endif %}
              </a>
              {% if foirequest.answer_exists %}
              <a href="{% url 'klageautomat-edit-answer' foirequest.id %}" class="btn btn-link btn-sm">Klage bearbeiten</a>
              {% endif %}
            </div>
          </div>
        </li>
        {% endfor %}
      </ul>
      {% else %}
        {% if request.GET.Search or request.GET.myRequests == "on" %}
        <div class="alert alert-info mt-5" role="alert">
          Nichts gefunden!
        </div>
        {% endif %}
      {% endif %}
    </div>
  </div>
</div>
{% endblock %}